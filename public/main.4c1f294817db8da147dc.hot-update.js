/*! For license information please see main.4c1f294817db8da147dc.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatehermann("main",{"./app/pages/Home/index.js":(t,e,n)=>{n.r(e),n.d(e,{default:()=>y});var i=n("./app/classes/Page.js"),o=n("./node_modules/lodash/lodash.js"),r=n("./node_modules/gsap/index.js");function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,u(i.key),i)}}function u(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}function s(t,e,n){return e=f(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,n||[],f(t).constructor):e.apply(t,n))}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function d(t,e,n,i){var o=h(f(1&i?t.prototype:t),e,n);return 2&i&&"function"==typeof o?function(t){return o.apply(n,t)}:o}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},h.apply(null,arguments)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}var y=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=s(this,e,[{id:"home",element:".home",elements:{galleries:".gallery__image",slider:".slider",revealer:".revealer",galleryName:".revealer__text",details:".gallery__details__item",indicators:".indicator-dot",pinnedArt:".pinned-art",artworkContainer:".pinned-art .artwork"}}])).rotation=0,t.rotationSpeed=10,t.currentSpeed=0,t.directionMultiplier=1,t.lastTime=performance.now(),t.touchStart=null,t.touchY=null,t.lastDeltaY=0,t.lastDeltaX=0,t.touchVelocity=0,t.isTouching=!1,t.isInitializing=!1,t.initialSpeed=860,t.initialStartTime=null,t.initialDuration=2700,t.onNavigationCallback=null,t.boundWheel=t.onWheel.bind(t),t.boundTouchStart=t.onTouchStart.bind(t),t.boundTouchMove=t.onTouchMove.bind(t),t.boundTouchEnd=t.onTouchEnd.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(e,t),n=e,(i=[{key:"initializePinnedArt",value:function(){console.log("initialize pinned art"),r.default.set(this.elements.pinnedArt,{opacity:0})}},{key:"setupPinnedArt",value:function(){console.log("set up being called"),this.elements.pinnedArt&&(r.default.set(this.elements.pinnedArt,{opacity:1}),r.default.timeline({delay:1}).from(this.elements.pinnedArt,{y:-100,opacity:0,duration:1,ease:"elastic.out(1, 0.5)"}),r.default.to(this.elements.artworkContainer,{opacity:1,rotation:"2",duration:2,yoyo:!0,repeat:-1,ease:"power1.inOut"}))}},{key:"create",value:function(){d(e,"create",this,3)([]),this.setupRotation(),this.addEventListener()}},{key:"setupRotation",value:function(){var t=this.elements.slider;t.style.transformStyle="preserve-3d",t.style.transform="perspective(1000px) rotateX(-16deg) rotateY(0deg)",this.startRotationLoop()}},{key:"initialSpeedUp",value:function(){this.isInitializing=!0}},{key:"startRotationLoop",value:function(){var t=this,e=function(n){var i=(n-t.lastTime)/1e3;if(t.lastTime=n,t.isInitializing){t.initialStartTime||(t.initialStartTime=n);var o=n-t.initialStartTime,r=Math.min(o/t.initialDuration,1);t.currentSpeed=(t.initialSpeed-(t.initialSpeed-t.rotationSpeed)*r)*t.directionMultiplier,1===r&&(t.isInitializing=!1,t.setupPinnedArt())}else{var a=t.rotationSpeed*t.directionMultiplier;t.currentSpeed+=.2*(a-t.currentSpeed)}t.rotation+=t.currentSpeed*i,t.elements.slider.style.transform="perspective(1000px) rotateX(-16deg) rotateY(".concat(t.rotation,"deg)"),Math.abs(Math.abs(t.currentSpeed)-t.rotationSpeed)<.1&&t.updateDetailsAndIndicators(t.rotation),t.rotationFrame=requestAnimationFrame(e)};this.rotationFrame=requestAnimationFrame(e)}},{key:"updateDetailsAndIndicators",value:function(t){var e=(t%360+360)%360,n=Math.floor(e/360*6);-1===this.directionMultiplier&&(n=(n-1+6)%6),this.elements.details.forEach((function(t,e){r.default.to(t,{opacity:e===n?1:0,duration:.1,ease:"ease"})})),this.elements.indicators.forEach((function(t,e){t.style.backgroundColor=e===n?"hsl(78, 100%, 15%)":"hsla(78, 100%, 15%, 0.3)"})),this.elements.galleries.forEach((function(t,e){var i=t.querySelector("img");r.default.to(i,{filter:e===n?"grayscale(0%)":"grayscale(100%)",duration:.5})}))}},{key:"onWheel",value:function(t){t.preventDefault();var e=Math.abs(t.deltaY)>Math.abs(t.deltaX)?1.5*t.deltaY:1.5*t.deltaX;Math.abs(e)>1&&(this.directionMultiplier=e>0?-1:1);var n=Math.abs(e);e>0&&this.directionMultiplier<0||e<0&&this.directionMultiplier>0?this.currentSpeed=this.directionMultiplier*Math.max(this.rotationSpeed,n):this.currentSpeed=n*this.directionMultiplier}},{key:"onTouchStart",value:function(t){this.isTouching=!0,this.touchStart=t.touches[0].clientY,this.touchStart={x:t.touches[0].clientX,y:t.touches[0].clientY},this.touchY=this.touchStart.y,this.touchX=this.touchStart.x,this.touchVelocity=0}},{key:"onTouchMove",value:function(t){if(this.isTouching){var e=t.touches[0].clientY,n=t.touches[0].clientX,i=this.touchY-e,o=this.touchX-n,r=Math.abs(o)>Math.abs(i)?2*o:i;this.touchVelocity=r,this.onWheel({preventDefault:function(){},deltaY:2*r,deltaX:0}),this.touchStart={x:n,y:e},this.touchY=e,this.touchX=n}}},{key:"onTouchEnd",value:function(){var t=this;this.isTouching=!1;var e=15*this.touchVelocity,n=function(){Math.abs(e)>.1&&(t.onWheel({preventDefault:function(){},deltaY:e,deltaX:0}),e*=.95,requestAnimationFrame(n))};requestAnimationFrame(n),this.touchStart=null,this.touchY=null}},{key:"onGalleryClick",value:function(t,e){e.preventDefault(),e.stopPropagation();var n=t.querySelector("a"),i=t.querySelector("img"),o=n.getAttribute("href");this.onNavigationCallback=function(){window.app.onChange({url:o})},this.galleryName=i.alt,this.elements.galleryName.innerText=this.galleryName,this.animateTransition()}},{key:"animateTransition",value:function(){var t=this,e=r.default.timeline(),n=Math.max(2*window.innerHeight,2*window.innerWidth);return e.set(this.elements.revealer,{display:"flex",y:"".concat(n,"px"),rotate:20}),e.set(this.elements.galleryName,{opacity:0,rotate:-20}),e.addLabel("firstHalf").to(this.elements.revealer,{y:"0",duration:1.2,ease:"power3.inOut"},"firstHalf").to(this.elements.galleryName,{opacity:1,duration:.8,ease:"power2.out"},"firstHalf+=0.4"),e.call((function(){t.onNavigationCallback&&(t.onNavigationCallback(),t.onNavigationCallback=null)}),null,"+=0.5"),e.addLabel("secondHalf").to(this.elements.galleryName,{opacity:0,duration:.6,ease:"power2.in"},"secondHalf").to(this.elements.revealer,{y:"-".concat(n,"px"),duration:2,rotate:20,ease:"power3.inOut"},"secondHalf+=0.2"),e.set(this.elements.revealer,{display:"none"}),e}},{key:"addEventListener",value:function(){var t=this;window.addEventListener("wheel",this.boundWheel,{passive:!1}),"ontouchstart"in window&&(window.addEventListener("touchstart",this.boundTouchStart),window.addEventListener("touchmove",this.boundTouchMove),window.addEventListener("touchend",this.boundTouchEnd)),o.forEach(this.elements.galleries,(function(e){var n=e.querySelector("a");t.boundGalleryClick=t.onGalleryClick.bind(t,e),n.addEventListener("click",t.boundGalleryClick)}))}},{key:"removeEventListeners",value:function(){var t=this;window.removeEventListener("wheel",this.boundWheel),"ontouchstart"in window&&(window.removeEventListener("touchstart",this.boundTouchStart),window.removeEventListener("touchmove",this.boundTouchMove),window.removeEventListener("touchend",this.boundTouchEnd)),o.forEach(this.elements.galleries,(function(e){e.querySelector("a").removeEventListener("click",t.boundGalleryClick)}))}},{key:"destroy",value:function(){this.rotationFrame&&cancelAnimationFrame(this.rotationFrame),this.removeEventListeners(),d(e,"destroy",this,3)([])}}])&&l(n.prototype,i),a&&l(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,a}(i.default)}},(function(t){t.h=()=>"681b4def890ca93984bf"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YW5uLy4vYXBwL3BhZ2VzL0hvbWUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vaGVybWFubi93ZWJwYWNrL3J1bnRpbWUvZ2V0RnVsbEhhc2giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFBhZ2UgZnJvbSBcImNsYXNzZXMvUGFnZS5qc1wiO1xuaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0IEdTQVAgZnJvbSBcImdzYXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZSBleHRlbmRzIFBhZ2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcih7XG4gICAgICBpZDogXCJob21lXCIsXG4gICAgICBlbGVtZW50OiBcIi5ob21lXCIsXG4gICAgICBlbGVtZW50czoge1xuICAgICAgICBnYWxsZXJpZXM6IFwiLmdhbGxlcnlfX2ltYWdlXCIsXG4gICAgICAgIHNsaWRlcjogXCIuc2xpZGVyXCIsXG4gICAgICAgIHJldmVhbGVyOiBcIi5yZXZlYWxlclwiLFxuICAgICAgICBnYWxsZXJ5TmFtZTogXCIucmV2ZWFsZXJfX3RleHRcIixcbiAgICAgICAgZGV0YWlsczogXCIuZ2FsbGVyeV9fZGV0YWlsc19faXRlbVwiLFxuICAgICAgICBpbmRpY2F0b3JzOiBcIi5pbmRpY2F0b3ItZG90XCIsXG4gICAgICAgIHBpbm5lZEFydDogXCIucGlubmVkLWFydFwiLFxuICAgICAgICBhcnR3b3JrQ29udGFpbmVyOiBcIi5waW5uZWQtYXJ0IC5hcnR3b3JrXCIsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gUm90YXRpb24gc3lzdGVtXG4gICAgdGhpcy5yb3RhdGlvbiA9IDA7XG4gICAgdGhpcy5yb3RhdGlvblNwZWVkID0gMzYwIC8gMzY7XG4gICAgdGhpcy5jdXJyZW50U3BlZWQgPSAwO1xuICAgIHRoaXMuZGlyZWN0aW9uTXVsdGlwbGllciA9IDE7XG5cbiAgICB0aGlzLmxhc3RUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAvLyBUb3VjaCB0cmFja2luZyBwcm9wZXJ0aWVzXG4gICAgdGhpcy50b3VjaFN0YXJ0ID0gbnVsbDtcbiAgICB0aGlzLnRvdWNoWSA9IG51bGw7XG4gICAgdGhpcy5sYXN0RGVsdGFZID0gMDtcbiAgICB0aGlzLmxhc3REZWx0YVggPSAwO1xuXG4gICAgdGhpcy50b3VjaFZlbG9jaXR5ID0gMDtcbiAgICB0aGlzLmlzVG91Y2hpbmcgPSBmYWxzZTtcblxuICAgIC8vIEluaXRpYWxpemF0aW9uIHN0YXRlc1xuICAgIHRoaXMuaXNJbml0aWFsaXppbmcgPSBmYWxzZTtcbiAgICB0aGlzLmluaXRpYWxTcGVlZCA9IDg2MDtcbiAgICB0aGlzLmluaXRpYWxTdGFydFRpbWUgPSBudWxsO1xuICAgIHRoaXMuaW5pdGlhbER1cmF0aW9uID0gMjcwMDtcblxuICAgIC8vIE5hdmlnYXRpb24gc3RhdGVcbiAgICB0aGlzLm9uTmF2aWdhdGlvbkNhbGxiYWNrID0gbnVsbDtcblxuICAgIC8vIEJpbmQgZXZlbnQgaGFuZGxlcnNcbiAgICB0aGlzLmJvdW5kV2hlZWwgPSB0aGlzLm9uV2hlZWwuYmluZCh0aGlzKTtcbiAgICB0aGlzLmJvdW5kVG91Y2hTdGFydCA9IHRoaXMub25Ub3VjaFN0YXJ0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5ib3VuZFRvdWNoTW92ZSA9IHRoaXMub25Ub3VjaE1vdmUuYmluZCh0aGlzKTtcbiAgICB0aGlzLmJvdW5kVG91Y2hFbmQgPSB0aGlzLm9uVG91Y2hFbmQuYmluZCh0aGlzKTtcbiAgfVxuICBpbml0aWFsaXplUGlubmVkQXJ0KCkge1xuICAgIGNvbnNvbGUubG9nKFwiaW5pdGlhbGl6ZSBwaW5uZWQgYXJ0XCIpO1xuICAgIEdTQVAuc2V0KHRoaXMuZWxlbWVudHMucGlubmVkQXJ0LCB7XG4gICAgICBvcGFjaXR5OiAwLFxuICAgIH0pO1xuICB9XG5cbiAgc2V0dXBQaW5uZWRBcnQoKSB7XG4gICAgY29uc29sZS5sb2coXCJzZXQgdXAgYmVpbmcgY2FsbGVkXCIpO1xuICAgIGlmICh0aGlzLmVsZW1lbnRzLnBpbm5lZEFydCkge1xuICAgICAgR1NBUC5zZXQodGhpcy5lbGVtZW50cy5waW5uZWRBcnQsIHtcbiAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgdGwgPSBHU0FQLnRpbWVsaW5lKHsgZGVsYXk6IDEgfSk7XG5cbiAgICAgIHRsLmZyb20odGhpcy5lbGVtZW50cy5waW5uZWRBcnQsIHtcbiAgICAgICAgeTogLTEwMCxcbiAgICAgICAgb3BhY2l0eTogMCxcbiAgICAgICAgZHVyYXRpb246IDEsXG4gICAgICAgIGVhc2U6IFwiZWxhc3RpYy5vdXQoMSwgMC41KVwiLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIHN1YnRsZSBzd2luZyBhbmltYXRpb25cbiAgICAgIEdTQVAudG8odGhpcy5lbGVtZW50cy5hcnR3b3JrQ29udGFpbmVyLCB7XG4gICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgIHJvdGF0aW9uOiBcIjJcIixcbiAgICAgICAgZHVyYXRpb246IDIsXG4gICAgICAgIHlveW86IHRydWUsXG4gICAgICAgIHJlcGVhdDogLTEsXG4gICAgICAgIGVhc2U6IFwicG93ZXIxLmluT3V0XCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjcmVhdGUoKSB7XG4gICAgc3VwZXIuY3JlYXRlKCk7XG4gICAgdGhpcy5zZXR1cFJvdGF0aW9uKCk7XG5cbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgfVxuXG4gIHNldHVwUm90YXRpb24oKSB7XG4gICAgY29uc3Qgc2xpZGVyID0gdGhpcy5lbGVtZW50cy5zbGlkZXI7XG4gICAgc2xpZGVyLnN0eWxlLnRyYW5zZm9ybVN0eWxlID0gXCJwcmVzZXJ2ZS0zZFwiO1xuICAgIHNsaWRlci5zdHlsZS50cmFuc2Zvcm0gPVxuICAgICAgXCJwZXJzcGVjdGl2ZSgxMDAwcHgpIHJvdGF0ZVgoLTE2ZGVnKSByb3RhdGVZKDBkZWcpXCI7XG4gICAgdGhpcy5zdGFydFJvdGF0aW9uTG9vcCgpO1xuICB9XG5cbiAgaW5pdGlhbFNwZWVkVXAoKSB7XG4gICAgdGhpcy5pc0luaXRpYWxpemluZyA9IHRydWU7XG4gIH1cblxuICBzdGFydFJvdGF0aW9uTG9vcCgpIHtcbiAgICBjb25zdCBhbmltYXRlID0gKGN1cnJlbnRUaW1lKSA9PiB7XG4gICAgICBjb25zdCBkZWx0YVRpbWUgPSAoY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUaW1lKSAvIDEwMDA7XG4gICAgICB0aGlzLmxhc3RUaW1lID0gY3VycmVudFRpbWU7XG5cbiAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6aW5nKSB7XG4gICAgICAgIGlmICghdGhpcy5pbml0aWFsU3RhcnRUaW1lKSB0aGlzLmluaXRpYWxTdGFydFRpbWUgPSBjdXJyZW50VGltZTtcblxuICAgICAgICBjb25zdCBlbGFwc2VkVGltZSA9IGN1cnJlbnRUaW1lIC0gdGhpcy5pbml0aWFsU3RhcnRUaW1lO1xuICAgICAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgubWluKGVsYXBzZWRUaW1lIC8gdGhpcy5pbml0aWFsRHVyYXRpb24sIDEpO1xuXG4gICAgICAgIHRoaXMuY3VycmVudFNwZWVkID1cbiAgICAgICAgICAodGhpcy5pbml0aWFsU3BlZWQgLVxuICAgICAgICAgICAgKHRoaXMuaW5pdGlhbFNwZWVkIC0gdGhpcy5yb3RhdGlvblNwZWVkKSAqIHByb2dyZXNzKSAqXG4gICAgICAgICAgdGhpcy5kaXJlY3Rpb25NdWx0aXBsaWVyO1xuXG4gICAgICAgIGlmIChwcm9ncmVzcyA9PT0gMSkge1xuICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXppbmcgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLnNldHVwUGlubmVkQXJ0KCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFNwZWVkID0gdGhpcy5yb3RhdGlvblNwZWVkICogdGhpcy5kaXJlY3Rpb25NdWx0aXBsaWVyO1xuICAgICAgICB0aGlzLmN1cnJlbnRTcGVlZCArPSAodGFyZ2V0U3BlZWQgLSB0aGlzLmN1cnJlbnRTcGVlZCkgKiAwLjI7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucm90YXRpb24gKz0gdGhpcy5jdXJyZW50U3BlZWQgKiBkZWx0YVRpbWU7XG5cbiAgICAgIHRoaXMuZWxlbWVudHMuc2xpZGVyLnN0eWxlLnRyYW5zZm9ybSA9IGBwZXJzcGVjdGl2ZSgxMDAwcHgpIHJvdGF0ZVgoLTE2ZGVnKSByb3RhdGVZKCR7dGhpcy5yb3RhdGlvbn1kZWcpYDtcblxuICAgICAgaWYgKE1hdGguYWJzKE1hdGguYWJzKHRoaXMuY3VycmVudFNwZWVkKSAtIHRoaXMucm90YXRpb25TcGVlZCkgPCAwLjEpIHtcbiAgICAgICAgdGhpcy51cGRhdGVEZXRhaWxzQW5kSW5kaWNhdG9ycyh0aGlzLnJvdGF0aW9uKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yb3RhdGlvbkZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuICAgIH07XG5cbiAgICB0aGlzLnJvdGF0aW9uRnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7XG4gIH1cblxuICB1cGRhdGVEZXRhaWxzQW5kSW5kaWNhdG9ycyhyb3RhdGlvbikge1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRSb3RhdGlvbiA9ICgocm90YXRpb24gJSAzNjApICsgMzYwKSAlIDM2MDtcblxuICAgIGxldCBhY3RpdmVJbmRleCA9IE1hdGguZmxvb3IoKG5vcm1hbGl6ZWRSb3RhdGlvbiAvIDM2MCkgKiA2KTtcblxuICAgIGlmICh0aGlzLmRpcmVjdGlvbk11bHRpcGxpZXIgPT09IC0xKSB7XG4gICAgICBhY3RpdmVJbmRleCA9IChhY3RpdmVJbmRleCAtIDEgKyA2KSAlIDY7IC8vIFNoaWZ0IGJhY2t3YXJkLCB3cmFwIGFyb3VuZFxuICAgIH1cbiAgICB0aGlzLmVsZW1lbnRzLmRldGFpbHMuZm9yRWFjaCgoZGV0YWlsLCBpbmRleCkgPT4ge1xuICAgICAgR1NBUC50byhkZXRhaWwsIHtcbiAgICAgICAgb3BhY2l0eTogaW5kZXggPT09IGFjdGl2ZUluZGV4ID8gMSA6IDAsXG4gICAgICAgIGR1cmF0aW9uOiAwLjEsXG4gICAgICAgIGVhc2U6IFwiZWFzZVwiLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmVsZW1lbnRzLmluZGljYXRvcnMuZm9yRWFjaCgoaW5kaWNhdG9yLCBpbmRleCkgPT4ge1xuICAgICAgaW5kaWNhdG9yLnN0eWxlLmJhY2tncm91bmRDb2xvciA9XG4gICAgICAgIGluZGV4ID09PSBhY3RpdmVJbmRleFxuICAgICAgICAgID8gXCJoc2woNzgsIDEwMCUsIDE1JSlcIlxuICAgICAgICAgIDogXCJoc2xhKDc4LCAxMDAlLCAxNSUsIDAuMylcIjtcbiAgICB9KTtcblxuICAgIHRoaXMuZWxlbWVudHMuZ2FsbGVyaWVzLmZvckVhY2goKGdhbGxlcnksIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBpbWcgPSBnYWxsZXJ5LnF1ZXJ5U2VsZWN0b3IoXCJpbWdcIik7XG4gICAgICBHU0FQLnRvKGltZywge1xuICAgICAgICBmaWx0ZXI6IGluZGV4ID09PSBhY3RpdmVJbmRleCA/IFwiZ3JheXNjYWxlKDAlKVwiIDogXCJncmF5c2NhbGUoMTAwJSlcIixcbiAgICAgICAgZHVyYXRpb246IDAuNSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgb25XaGVlbChldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAvLyBHZXQgdGhlIGFic29sdXRlIHZhbHVlcyB0byBjb21wYXJlXG4gICAgY29uc3QgYWJzVmVydGljYWwgPSBNYXRoLmFicyhldmVudC5kZWx0YVkpO1xuICAgIGNvbnN0IGFic0hvcml6b250YWwgPSBNYXRoLmFicyhldmVudC5kZWx0YVgpO1xuXG4gICAgLy8gVXNlIHRoZSBsYXJnZXIgZGVsdGEgdmFsdWUgKGRvbWluYW50IGRpcmVjdGlvbilcbiAgICBjb25zdCBzY3JvbGxJbmZsdWVuY2UgPVxuICAgICAgYWJzVmVydGljYWwgPiBhYnNIb3Jpem9udGFsID8gZXZlbnQuZGVsdGFZICogMS41IDogZXZlbnQuZGVsdGFYICogMS41O1xuXG4gICAgaWYgKE1hdGguYWJzKHNjcm9sbEluZmx1ZW5jZSkgPiAxKSB7XG4gICAgICB0aGlzLmRpcmVjdGlvbk11bHRpcGxpZXIgPSBzY3JvbGxJbmZsdWVuY2UgPiAwID8gLTEgOiAxO1xuICAgIH1cblxuICAgIGNvbnN0IHNjcm9sbFNwZWVkID0gTWF0aC5hYnMoc2Nyb2xsSW5mbHVlbmNlKTtcblxuICAgIGlmIChcbiAgICAgIChzY3JvbGxJbmZsdWVuY2UgPiAwICYmIHRoaXMuZGlyZWN0aW9uTXVsdGlwbGllciA8IDApIHx8XG4gICAgICAoc2Nyb2xsSW5mbHVlbmNlIDwgMCAmJiB0aGlzLmRpcmVjdGlvbk11bHRpcGxpZXIgPiAwKVxuICAgICkge1xuICAgICAgdGhpcy5jdXJyZW50U3BlZWQgPVxuICAgICAgICB0aGlzLmRpcmVjdGlvbk11bHRpcGxpZXIgKiBNYXRoLm1heCh0aGlzLnJvdGF0aW9uU3BlZWQsIHNjcm9sbFNwZWVkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jdXJyZW50U3BlZWQgPSBzY3JvbGxTcGVlZCAqIHRoaXMuZGlyZWN0aW9uTXVsdGlwbGllcjtcbiAgICB9XG4gIH1cblxuICBvblRvdWNoU3RhcnQoZXZlbnQpIHtcbiAgICAvLyAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmlzVG91Y2hpbmcgPSB0cnVlO1xuICAgIHRoaXMudG91Y2hTdGFydCA9IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WTtcbiAgICB0aGlzLnRvdWNoU3RhcnQgPSB7XG4gICAgICB4OiBldmVudC50b3VjaGVzWzBdLmNsaWVudFgsXG4gICAgICB5OiBldmVudC50b3VjaGVzWzBdLmNsaWVudFksXG4gICAgfTtcbiAgICB0aGlzLnRvdWNoWSA9IHRoaXMudG91Y2hTdGFydC55O1xuICAgIHRoaXMudG91Y2hYID0gdGhpcy50b3VjaFN0YXJ0Lng7XG5cbiAgICB0aGlzLnRvdWNoVmVsb2NpdHkgPSAwO1xuICB9XG5cbiAgb25Ub3VjaE1vdmUoZXZlbnQpIHtcbiAgICAvLyAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoIXRoaXMuaXNUb3VjaGluZykgcmV0dXJuO1xuXG4gICAgY29uc3QgY3VycmVudFkgPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFk7XG4gICAgY29uc3QgY3VycmVudFggPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7XG5cbiAgICAvLyBDYWxjdWxhdGUgZGVsdGFzXG4gICAgY29uc3QgZGVsdGFZID0gdGhpcy50b3VjaFkgLSBjdXJyZW50WTtcbiAgICBjb25zdCBkZWx0YVggPSB0aGlzLnRvdWNoWCAtIGN1cnJlbnRYO1xuXG4gICAgLy8gVXNlIHRoZSBkb21pbmFudCBkaXJlY3Rpb25cbiAgICBjb25zdCBhYnNEZWx0YVggPSBNYXRoLmFicyhkZWx0YVgpO1xuICAgIGNvbnN0IGFic0RlbHRhWSA9IE1hdGguYWJzKGRlbHRhWSk7XG4gICAgY29uc3QgZG9taW5hbnREZWx0YSA9IGFic0RlbHRhWCA+IGFic0RlbHRhWSA/IGRlbHRhWCAqIDIgOiBkZWx0YVk7XG5cbiAgICB0aGlzLnRvdWNoVmVsb2NpdHkgPSBkb21pbmFudERlbHRhO1xuXG4gICAgdGhpcy5vbldoZWVsKHtcbiAgICAgIHByZXZlbnREZWZhdWx0OiAoKSA9PiB7fSxcbiAgICAgIGRlbHRhWTogZG9taW5hbnREZWx0YSAqIDIsXG4gICAgICBkZWx0YVg6IDAsXG4gICAgfSk7XG5cbiAgICB0aGlzLnRvdWNoU3RhcnQgPSB7IHg6IGN1cnJlbnRYLCB5OiBjdXJyZW50WSB9O1xuXG4gICAgdGhpcy50b3VjaFkgPSBjdXJyZW50WTtcbiAgICB0aGlzLnRvdWNoWCA9IGN1cnJlbnRYO1xuICB9XG5cbiAgb25Ub3VjaEVuZCgpIHtcbiAgICB0aGlzLmlzVG91Y2hpbmcgPSBmYWxzZTtcblxuICAgIGNvbnN0IHN0YXJ0VmVsb2NpdHkgPSB0aGlzLnRvdWNoVmVsb2NpdHkgKiAxNTtcbiAgICBsZXQgY3VycmVudFZlbG9jaXR5ID0gc3RhcnRWZWxvY2l0eTtcblxuICAgIGNvbnN0IGRlY2F5ID0gKCkgPT4ge1xuICAgICAgaWYgKE1hdGguYWJzKGN1cnJlbnRWZWxvY2l0eSkgPiAwLjEpIHtcbiAgICAgICAgdGhpcy5vbldoZWVsKHtcbiAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogKCkgPT4ge30sXG4gICAgICAgICAgZGVsdGFZOiBjdXJyZW50VmVsb2NpdHksXG4gICAgICAgICAgZGVsdGFYOiAwLFxuICAgICAgICB9KTtcblxuICAgICAgICBjdXJyZW50VmVsb2NpdHkgKj0gMC45NTtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRlY2F5KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRlY2F5KTtcblxuICAgIHRoaXMudG91Y2hTdGFydCA9IG51bGw7XG4gICAgdGhpcy50b3VjaFkgPSBudWxsO1xuICB9XG5cbiAgb25HYWxsZXJ5Q2xpY2soZ2FsbGVyeSwgZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgY29uc3QgbGluayA9IGdhbGxlcnkucXVlcnlTZWxlY3RvcihcImFcIik7XG4gICAgY29uc3QgaW1nRWxlbWVudCA9IGdhbGxlcnkucXVlcnlTZWxlY3RvcihcImltZ1wiKTtcbiAgICBjb25zdCBocmVmID0gbGluay5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuXG4gICAgdGhpcy5vbk5hdmlnYXRpb25DYWxsYmFjayA9ICgpID0+IHtcbiAgICAgIHdpbmRvdy5hcHAub25DaGFuZ2UoeyB1cmw6IGhyZWYgfSk7XG4gICAgfTtcblxuICAgIHRoaXMuZ2FsbGVyeU5hbWUgPSBpbWdFbGVtZW50LmFsdDtcbiAgICB0aGlzLmVsZW1lbnRzLmdhbGxlcnlOYW1lLmlubmVyVGV4dCA9IHRoaXMuZ2FsbGVyeU5hbWU7XG5cbiAgICB0aGlzLmFuaW1hdGVUcmFuc2l0aW9uKCk7XG4gIH1cblxuICBhbmltYXRlVHJhbnNpdGlvbigpIHtcbiAgICBjb25zdCB0bCA9IEdTQVAudGltZWxpbmUoKTtcbiAgICBjb25zdCBtYXhEaW1lbnNpb24gPSBNYXRoLm1heChcbiAgICAgIHdpbmRvdy5pbm5lckhlaWdodCAqIDIsXG4gICAgICB3aW5kb3cuaW5uZXJXaWR0aCAqIDJcbiAgICApO1xuXG4gICAgdGwuc2V0KHRoaXMuZWxlbWVudHMucmV2ZWFsZXIsIHtcbiAgICAgIGRpc3BsYXk6IFwiZmxleFwiLFxuICAgICAgeTogYCR7bWF4RGltZW5zaW9ufXB4YCxcbiAgICAgIHJvdGF0ZTogMjAsXG4gICAgfSk7XG5cbiAgICB0bC5zZXQodGhpcy5lbGVtZW50cy5nYWxsZXJ5TmFtZSwge1xuICAgICAgb3BhY2l0eTogMCxcbiAgICAgIHJvdGF0ZTogLTIwLFxuICAgIH0pO1xuXG4gICAgdGwuYWRkTGFiZWwoXCJmaXJzdEhhbGZcIilcbiAgICAgIC50byhcbiAgICAgICAgdGhpcy5lbGVtZW50cy5yZXZlYWxlcixcbiAgICAgICAge1xuICAgICAgICAgIHk6IFwiMFwiLFxuICAgICAgICAgIGR1cmF0aW9uOiAxLjIsXG4gICAgICAgICAgZWFzZTogXCJwb3dlcjMuaW5PdXRcIixcbiAgICAgICAgfSxcbiAgICAgICAgXCJmaXJzdEhhbGZcIlxuICAgICAgKVxuICAgICAgLnRvKFxuICAgICAgICB0aGlzLmVsZW1lbnRzLmdhbGxlcnlOYW1lLFxuICAgICAgICB7XG4gICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICBkdXJhdGlvbjogMC44LFxuICAgICAgICAgIGVhc2U6IFwicG93ZXIyLm91dFwiLFxuICAgICAgICB9LFxuICAgICAgICBcImZpcnN0SGFsZis9MC40XCJcbiAgICAgICk7XG5cbiAgICB0bC5jYWxsKFxuICAgICAgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5vbk5hdmlnYXRpb25DYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMub25OYXZpZ2F0aW9uQ2FsbGJhY2soKTtcbiAgICAgICAgICB0aGlzLm9uTmF2aWdhdGlvbkNhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG51bGwsXG4gICAgICBcIis9MC41XCJcbiAgICApO1xuXG4gICAgdGwuYWRkTGFiZWwoXCJzZWNvbmRIYWxmXCIpXG4gICAgICAudG8oXG4gICAgICAgIHRoaXMuZWxlbWVudHMuZ2FsbGVyeU5hbWUsXG4gICAgICAgIHtcbiAgICAgICAgICBvcGFjaXR5OiAwLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLjYsXG4gICAgICAgICAgZWFzZTogXCJwb3dlcjIuaW5cIixcbiAgICAgICAgfSxcbiAgICAgICAgXCJzZWNvbmRIYWxmXCJcbiAgICAgIClcbiAgICAgIC50byhcbiAgICAgICAgdGhpcy5lbGVtZW50cy5yZXZlYWxlcixcbiAgICAgICAge1xuICAgICAgICAgIHk6IGAtJHttYXhEaW1lbnNpb259cHhgLFxuICAgICAgICAgIGR1cmF0aW9uOiAyLFxuICAgICAgICAgIHJvdGF0ZTogMjAsXG4gICAgICAgICAgZWFzZTogXCJwb3dlcjMuaW5PdXRcIixcbiAgICAgICAgfSxcbiAgICAgICAgXCJzZWNvbmRIYWxmKz0wLjJcIlxuICAgICAgKTtcblxuICAgIHRsLnNldCh0aGlzLmVsZW1lbnRzLnJldmVhbGVyLCB7IGRpc3BsYXk6IFwibm9uZVwiIH0pO1xuXG4gICAgcmV0dXJuIHRsO1xuICB9XG4gIGFkZEV2ZW50TGlzdGVuZXIoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCB0aGlzLmJvdW5kV2hlZWwsIHsgcGFzc2l2ZTogZmFsc2UgfSk7XG5cbiAgICBpZiAoXCJvbnRvdWNoc3RhcnRcIiBpbiB3aW5kb3cpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCB0aGlzLmJvdW5kVG91Y2hTdGFydCk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCB0aGlzLmJvdW5kVG91Y2hNb3ZlKTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgdGhpcy5ib3VuZFRvdWNoRW5kKTtcbiAgICB9XG5cbiAgICBfLmZvckVhY2godGhpcy5lbGVtZW50cy5nYWxsZXJpZXMsIChnYWxsZXJ5KSA9PiB7XG4gICAgICBjb25zdCBsaW5rID0gZ2FsbGVyeS5xdWVyeVNlbGVjdG9yKFwiYVwiKTtcbiAgICAgIHRoaXMuYm91bmRHYWxsZXJ5Q2xpY2sgPSB0aGlzLm9uR2FsbGVyeUNsaWNrLmJpbmQodGhpcywgZ2FsbGVyeSk7XG4gICAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmJvdW5kR2FsbGVyeUNsaWNrKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgdGhpcy5ib3VuZFdoZWVsKTtcblxuICAgIGlmIChcIm9udG91Y2hzdGFydFwiIGluIHdpbmRvdykge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIHRoaXMuYm91bmRUb3VjaFN0YXJ0KTtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIHRoaXMuYm91bmRUb3VjaE1vdmUpO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCB0aGlzLmJvdW5kVG91Y2hFbmQpO1xuICAgIH1cblxuICAgIF8uZm9yRWFjaCh0aGlzLmVsZW1lbnRzLmdhbGxlcmllcywgKGdhbGxlcnkpID0+IHtcbiAgICAgIGNvbnN0IGxpbmsgPSBnYWxsZXJ5LnF1ZXJ5U2VsZWN0b3IoXCJhXCIpO1xuICAgICAgbGluay5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5ib3VuZEdhbGxlcnlDbGljayk7XG4gICAgfSk7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLnJvdGF0aW9uRnJhbWUpIHtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMucm90YXRpb25GcmFtZSk7XG4gICAgfVxuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICBzdXBlci5kZXN0cm95KCk7XG4gIH1cbn1cbiIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcIjY4MWI0ZGVmODkwY2E5Mzk4NGJmXCIpIl0sIm5hbWVzIjpbIkhvbWUiLCJfUGFnZSIsIl90aGlzIiwiX2NsYXNzQ2FsbENoZWNrIiwiX2NhbGxTdXBlciIsImlkIiwiZWxlbWVudCIsImVsZW1lbnRzIiwiZ2FsbGVyaWVzIiwic2xpZGVyIiwicmV2ZWFsZXIiLCJnYWxsZXJ5TmFtZSIsImRldGFpbHMiLCJpbmRpY2F0b3JzIiwicGlubmVkQXJ0IiwiYXJ0d29ya0NvbnRhaW5lciIsInJvdGF0aW9uIiwicm90YXRpb25TcGVlZCIsImN1cnJlbnRTcGVlZCIsImRpcmVjdGlvbk11bHRpcGxpZXIiLCJsYXN0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwidG91Y2hTdGFydCIsInRvdWNoWSIsImxhc3REZWx0YVkiLCJsYXN0RGVsdGFYIiwidG91Y2hWZWxvY2l0eSIsImlzVG91Y2hpbmciLCJpc0luaXRpYWxpemluZyIsImluaXRpYWxTcGVlZCIsImluaXRpYWxTdGFydFRpbWUiLCJpbml0aWFsRHVyYXRpb24iLCJvbk5hdmlnYXRpb25DYWxsYmFjayIsImJvdW5kV2hlZWwiLCJvbldoZWVsIiwiYmluZCIsImJvdW5kVG91Y2hTdGFydCIsIm9uVG91Y2hTdGFydCIsImJvdW5kVG91Y2hNb3ZlIiwib25Ub3VjaE1vdmUiLCJib3VuZFRvdWNoRW5kIiwib25Ub3VjaEVuZCIsIl9pbmhlcml0cyIsImtleSIsInZhbHVlIiwiY29uc29sZSIsImxvZyIsIkdTQVAiLCJzZXQiLCJ0aGlzIiwib3BhY2l0eSIsInRpbWVsaW5lIiwiZGVsYXkiLCJmcm9tIiwieSIsImR1cmF0aW9uIiwiZWFzZSIsInRvIiwieW95byIsInJlcGVhdCIsIl9zdXBlclByb3BHZXQiLCJzZXR1cFJvdGF0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0eWxlIiwidHJhbnNmb3JtU3R5bGUiLCJ0cmFuc2Zvcm0iLCJzdGFydFJvdGF0aW9uTG9vcCIsIl90aGlzMiIsImFuaW1hdGUiLCJjdXJyZW50VGltZSIsImRlbHRhVGltZSIsImVsYXBzZWRUaW1lIiwicHJvZ3Jlc3MiLCJNYXRoIiwibWluIiwic2V0dXBQaW5uZWRBcnQiLCJ0YXJnZXRTcGVlZCIsImNvbmNhdCIsImFicyIsInVwZGF0ZURldGFpbHNBbmRJbmRpY2F0b3JzIiwicm90YXRpb25GcmFtZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm5vcm1hbGl6ZWRSb3RhdGlvbiIsImFjdGl2ZUluZGV4IiwiZmxvb3IiLCJmb3JFYWNoIiwiZGV0YWlsIiwiaW5kZXgiLCJpbmRpY2F0b3IiLCJiYWNrZ3JvdW5kQ29sb3IiLCJnYWxsZXJ5IiwiaW1nIiwicXVlcnlTZWxlY3RvciIsImZpbHRlciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJzY3JvbGxJbmZsdWVuY2UiLCJkZWx0YVkiLCJkZWx0YVgiLCJzY3JvbGxTcGVlZCIsIm1heCIsInRvdWNoZXMiLCJjbGllbnRZIiwieCIsImNsaWVudFgiLCJ0b3VjaFgiLCJjdXJyZW50WSIsImN1cnJlbnRYIiwiZG9taW5hbnREZWx0YSIsIl90aGlzMyIsImN1cnJlbnRWZWxvY2l0eSIsImRlY2F5Iiwic3RvcFByb3BhZ2F0aW9uIiwibGluayIsImltZ0VsZW1lbnQiLCJocmVmIiwiZ2V0QXR0cmlidXRlIiwid2luZG93IiwiYXBwIiwib25DaGFuZ2UiLCJ1cmwiLCJhbHQiLCJpbm5lclRleHQiLCJhbmltYXRlVHJhbnNpdGlvbiIsIl90aGlzNCIsInRsIiwibWF4RGltZW5zaW9uIiwiaW5uZXJIZWlnaHQiLCJpbm5lcldpZHRoIiwiZGlzcGxheSIsInJvdGF0ZSIsImFkZExhYmVsIiwiY2FsbCIsIl90aGlzNSIsInBhc3NpdmUiLCJfIiwiYm91bmRHYWxsZXJ5Q2xpY2siLCJvbkdhbGxlcnlDbGljayIsIl90aGlzNiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsInJlbW92ZUV2ZW50TGlzdGVuZXJzIiwiUGFnZSIsIl9fd2VicGFja19yZXF1aXJlX18iLCJoIl0sInNvdXJjZVJvb3QiOiIifQ==